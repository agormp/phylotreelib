import phylotreelib as pt
import pytest

############################################################################################

@pytest.fixture()
def treedata():

    treedata = {"simplestring" :
                        "(((s1:0.12500,s2:0.12500):0.25000,s3:0.12500):0.12500,s4:0.12500,S5:0.12500);",

               "string_with_blanks" :
                        "(((s1:0.12500, s2:0.12500): 0.25000,s3: 0.12500): 0.12500, s4:0.12500 ,S5:0.12500);",

               "string_with_newlines" :
                         """(((s1:0.12500,s2:0.12500):0.25000,
                                            s3:0.12500):0.12500,s4:0.12500,S5:0.12500);""",

               "string_with_label" :
                         """(KL0F07689: 0.101408, KW081_13: 0.071355,
                            (SBC669_26: 0.009364, YAL016W: 0.014955)0.0507 : 0.124263);""",

                "string_with_weird_newlines":
                         """((SIVCZ:0.19506,(((HV1EL:0.07434000000000002,HV1Z2:0.05618000000000001)
                            :0.023249999999999993, HV1Z8:0.09005000000000002):0.03898999999999997,(HV1MN:
                            0.08418999999999993,((HV1C4:0.09445999999999999,
                            HV1KB:0.08659):0.007830000000000004,(HV1W1:0.08096999999999999,(((HV1A2:0.07867000000000002,
                            HV1JR:0.05537000000000003):0.006249999999999978,((HV1BR:0.006839999999999957,
                            HV1H3:0.007709999999999995):0.0038600000000000856,
                            HV1B1:0.008610000000000007):0.06370999999999993):0.005840000000000067,
                            (HV1RH:0.09736999999999996,HV1S1:0.05908000000000002):0.0027200000000000557)
                            :0.005549999999999944):6.300000000000194E-4):0.006160000000000054):0.0441399999
                            9999996):0.05684):0.16576,
                            ((((((HV2BE:0.08623000000000003,HV2D1:0.08114999999999994):0.024009999999999976,
                            HV2SB:0.09655000000000002):0.003249999999999975,(((HV2S2:0.005730000000000013,
                            HV2ST:0.006879999999999997):0.06057000000000001,HV2G1:0.060250000000000026):0.012259999999999993,
                            HV2RO:0.08071):0.011629999999999974):0.004300000000000026,HV2CA:0.09954000000000002):0.0015800000000000258,
                            HV2NZ:0.10410999999999998):0.01651999999999998,((SIVMK:0.008000000000000007,
                            SIVML:0.007839999999999958):0.036290000000000044,SIVM1:0.04786999999999997):0.10249999999999998):0.16576);""",

                "complexstring" :
                         """((gi|13272696|gb|AF346973.1|:0.001343,(gi|13272836|gb|AF346983.1|:0.000510,
                            gi|13272822|gb|AF346982.1|:0.000993):0.000161):0.000026,(gi|13273158|gb|AF347006.1|:0.000499,
                            (gi|13272766|gb|AF346978.1|:0.000332,((gi|13272710|gb|AF346974.1|:0.000222,
                            gi|13272724|gb|AF346975.1|:0.000279):0.000071,
                            gi|13272808|gb|AF346981.1|:0.000242):0.000107):0.000034):0.000081,
                            (((gi|13272668|gb|AF346971.1|:0.000930,((((gi|13273074|gb|AF347000.1|:0.001594,
                            ((gi|13272584|gb|AF346965.1|:0.001348,gi|13273116|gb|AF347003.1|:0.001283):0.000043,
                            ((gi|13272598|gb|AF346966.1|:0.000743,gi|13272682|gb|AF346972.1|:0.000760):0.000043,
                            ((gi|13272850|gb|AF346984.1|:0.000657,(gi|13272920|gb|AF346989.1|:0.000530,
                            (gi|13272934|gb|AF346990.1|:0.000322,
                            gi|13273214|gb|AF347010.1|:0.000680):0.000033):0.000063):0.000279,
                            (((gi|13272654|gb|AF346970.1|:0.000192,gi|13272948|gb|AF346991.1|:0.000121):0.000068,
                            gi|13272780|gb|AF346979.1|:0.000559):0.000244,(gi|13273242|gb|AF347012.1|:-0.000000,
                            gi|13273256|gb|AF347013.1|:0.000063):0.000445):0.000598):0.000043):0.000025):0.000143):0.000016,
                            (((gi|13273284|gb|AF347015.1|:0.000508,gi|13272990|gb|AF346994.1|:0.000244):0.000298,
                            gi|13272612|gb|AF346967.1|:0.000955):0.000034,
                            gi|13272794|gb|AF346980.1|:0.000593):0.000151):0.000027,
                            gi|13273270|gb|AF347014.1|:0.001198):0.000008,((((gi|13272962|gb|AF346992.1|:0.001676,
                            (((gi|13272640|gb|AF346969.1|:0.000000,gi|13273018|gb|AF346996.1|:0.000062):0.000951,
                            (gi|13272626|gb|AF346968.1|:0.000075,gi|13273032|gb|AF346997.1|:0.000239):0.000803):0.000182,
                            gi|13272892|gb|AF346987.1|:0.000852):0.000250):0.000765,
                            gi|13272878|gb|AF346986.1|:0.001647):0.000504,(((gi|5835121|ref|NC_001643.1|:0.020174,
                            gi|5835135|ref|NC_001644.1|:0.019162):0.059964,gi|195972535|emb|AM948965.1|:0.005335):0.004078,
                            ((gi|13273200|gb|AF347009.1|:0.000242,gi|13273186|gb|AF347008.1|:0.000197):0.001923,
                            (gi|13272864|gb|AF346985.1|:0.000389,(gi|13273060|gb|AF346999.1|:0.000051,
                            gi|13273046|gb|AF346998.1|:0.000012):0.000801):0.000959):0.000823):0.000241):0.000610,
                            ((gi|13272752|gb|AF346977.1|:0.000502,gi|13272738|gb|AF346976.1|:0.000375):0.000581,
                            gi|13273004|gb|AF346995.1|:0.001111):0.000438):0.000482):0.000276):0.000025,
                            (gi|13272556|gb|AF346963.1|:0.000776,gi|13272570|gb|AF346964.1|:0.000978):0.000039):0.000093,
                            (((gi|13273088|gb|AF347001.1|:0.000969,((gi|13273172|gb|AF347007.1|:0.000449,
                            gi|13272976|gb|AF346993.1|:0.000490):0.000313,
                            gi|13273228|gb|AF347011.1|:0.000627):0.000033):0.000112,
                            gi|13272906|gb|AF346988.1|:0.000890):0.000045,((gi|13273102|gb|AF347002.1|:0.000553,
                            gi|13273144|gb|AF347005.1|:0.000825):0.000155,
                            gi|13273130|gb|AF347004.1|:0.000597):0.000268):0.000023):0.000019);""",

                "HIVtree" :
                         """((SIVCZ:0.19506,(((HV1EL:0.07434000000000002,HV1Z2:0.05618000000000001):0.023249999999999993,
                            HV1Z8:0.09005000000000002):0.03898999999999997,(HV1MN:0.08418999999999993,((HV1C4:0.09445999999999999,
                            HV1KB:0.08659):0.007830000000000004,(HV1W1:0.08096999999999999,(((HV1A2:0.07867000000000002,
                            HV1JR:0.05537000000000003):0.006249999999999978,((HV1BR:0.006839999999999957,
                            HV1H3:0.007709999999999995):0.0038600000000000856,
                            HV1B1:0.008610000000000007):0.06370999999999993):0.005840000000000067,
                            (HV1RH:0.09736999999999996,HV1S1:0.05908000000000002):0.0027200000000000557)
                            :0.005549999999999944):6.300000000000194E-4):0.006160000000000054):0.04413999999999996):0.05684):0.16576,
                            ((((((HV2BE:0.08623000000000003,HV2D1:0.08114999999999994):0.024009999999999976,
                            HV2SB:0.09655000000000002):0.003249999999999975,(((HV2S2:0.005730000000000013,
                            HV2ST:0.006879999999999997):0.06057000000000001,HV2G1:0.060250000000000026):0.012259999999999993,
                            HV2RO:0.08071):0.011629999999999974):0.004300000000000026,HV2CA:0.09954000000000002):0.0015800000000000258,
                            HV2NZ:0.10410999999999998):0.01651999999999998,((SIVMK:0.008000000000000007,
                            SIVML:0.007839999999999958):0.036290000000000044,SIVM1:0.04786999999999997):0.10249999999999998):0.16576);""",
                "HIVtree_HV1A2root" :
                            """((HV1JR:0.05537000000000003,(((HV1BR:0.006839999999999957,HV1H3:0.007709999999999995):0.0038600000000000856,
                            HV1B1:0.008610000000000007):0.06370999999999993,((HV1RH:0.09736999999999996,HV1S1:0.05908000000000002):0.0027200000000000557,
                            (HV1W1:0.08096999999999999,((HV1C4:0.09445999999999999,HV1KB:0.08659):0.007830000000000004,(HV1MN:0.08418999999999993,
                            (((HV1EL:0.07434000000000002,HV1Z2:0.05618000000000001):0.023249999999999993,HV1Z8:0.09005000000000002):0.03899,
                            (SIVCZ:0.19506000000000004,((((((HV2BE:0.08623,HV2D1:0.08114999999999992):0.024009999999999976,
                            HV2SB:0.09655):0.003249999999999975,(((HV2S2:0.005730000000000013,HV2ST:0.006879999999999997):0.060569999999999985,
                            HV2G1:0.06025):0.012259999999999993,HV2RO:0.08070999999999998):0.011629999999999974):0.004300000000000026,
                            HV2CA:0.09953999999999999):0.0015800000000000258,HV2NZ:0.10410999999999995):0.01651999999999998,
                            ((SIVMK:0.008000000000000007,SIVML:0.007839999999999958):0.036290000000000044,
                            SIVM1:0.04786999999999997):0.10249999999999995):0.33152):0.05684):0.044139999999999985):0.006160000000000054):
                            6.300000000000194E-4):0.005549999999999944):0.005840000000000067):0.006249999999999978):0.03933500000000001,
                            HV1A2:0.03933500000000001);""",
                "HIVminvar":
                            """((((HV1Z8:0.09005,(HV1EL:0.07434,HV1Z2:0.05618):0.02325):0.03899,(HV1MN:0.08419,((HV1W1:0.08097,
                                (((HV1A2:0.07867,HV1JR:0.05537):0.00625,((HV1BR:0.00684,HV1H3:0.00771):0.00386,HV1B1:0.00861):0.06371):0.00584,
                                (HV1S1:0.05908,HV1RH:0.09737):0.00272):0.00555):0.00063,(HV1C4:0.09446,
                                HV1KB:0.08659):0.00783):0.00616):0.04414):0.05684,SIVCZ:0.19506):0.132787,
                                ((((((HV2D1:0.08115,HV2BE:0.08623):0.02401,HV2SB:0.09655):0.00325,(HV2RO:0.08071,
                                (HV2G1:0.06025,(HV2ST:0.00688,HV2S2:0.00573):0.06057):0.01226):0.01163):0.0043,HV2CA:0.09954):0.00158,
                                HV2NZ:0.10411):0.01652,(SIVM1:0.04787,(SIVML:0.00784,SIVMK:0.008):0.03629):0.1025):0.198733);"""
                            }

    return treedata

############################################################################################

